{% extends '::base.html.twig' %}

{% block body -%}


<div class="row">
    <div class="col-sm-9">
        
        <h1><span>Event Registration</span></h1>

        <div class="">
            {% include 'PixeloidAppBundle:FormFlow:stepList.html.twig' %}
        </div>


        <hr>

        {{ form_start(form, {attr: {'data-calculate-url': path('eventregistration_calculate') }}) }}

        {% if flow.getCurrentStepNumber() == 1 %}
        <div class="row">
            <div class="col-sm-6">
                {{ form_row(form.registrantType) }}
            </div>
            <div class="col-sm-6">
                {{ form_row(form.reg_number) }}
            </div>


        </div>
        <div class="row">
            <div class="col-sm-1">
                {{ form_row(form.title) }}
            </div>
            <div class="col-sm-3">
                {{ form_row(form.firstname) }}
            </div>

            <div class="col-sm-3">
                {{ form_row(form.lastname) }}
            </div>
            <div class="col-sm-5">
                {{ form_row(form.institution) }}
            </div>

        </div>
        <div class="row">
            <div class="col-sm-2">
                {{ form_row(form.country) }}
            </div>
            <div class="col-sm-2">
                {{ form_row(form.postal) }}
            </div>

            <div class="col-sm-3">
                {{ form_row(form.city) }}
            </div>
            <div class="col-sm-5">
                {{ form_row(form.address) }}
            </div>
        </div>
        <div class="row">
            <div class="col-sm-4">
                {{ form_row(form.email) }}
            </div>
            <div class="col-sm-4">
                {{ form_row(form.phone) }}
            </div>

            <div class="col-sm-4">
                {{ form_row(form.fax) }}
            </div>
        </div>

        <div class="row">
            <div class="col-sm-4">
                {{ form_row(form.extra1) }}
            </div>
            <div class="col-sm-4">
                {{ form_row(form.extra2) }}
            </div>
            <div class="col-sm-4">
                {{ form_row(form.extra3) }}
            </div>
        </div>


        {% elseif flow.getCurrentStepNumber() == 2 %}


    <!--         <h2>Available accomodation options</h2>
     --><div class="row">
            <div class="col-sm-8">


                <table class="table table-condensed table-decorated">

                {% for acc in accomodations %}
                
                <tr>
                    <th colspan="2">{{acc.name}} ({{acc.address}})</th>
                    <th><a href="#" class="btn btn-xs btn-info">Bővebb információ </a></th>
                </tr>
                {% for room in acc.getRooms() %}
                
                    <tr>
                        <td>{{room.getRoomType.getName}}</td>
                        <td>{{room.getPrice|number_format(0,'', ' ')}} Ft / éjszaka</td>
            <!--             <td class="text-center"><input type="checkbox" class="checkbox"></td>
                        <td><input type="checkbox" class="checkbox"></td>
             -->        <td><input type="radio" name="selectedroom" value="{{room.id}}"></td>    
                    </tr>

                {% endfor %}

                {% endfor %}
                </table>

                {{ form_row(form.roomReservation.room) }}


            </div>
            <div class="col-sm-4">
                        
                    <div class="bootstrap-date">
                        {{ form_row(form.roomReservation.checkIn) }}
                    </div>
                    <div class="bootstrap-date">
                        {{ form_row(form.roomReservation.checkOut) }}
                    </div>
                    {{ form_row(form.roomReservation.persons) }}

            </div>


        </div>

        {% elseif flow.getCurrentStepNumber() == 3 %}

        <div class="row">
            <div class="col-sm-8">


            {% set datesArray = [] %}


            {% for diningGroup in form.diningDates.vars.choices %}
                {% for dining in diningGroup %}
                    {% if dining.data.date not in datesArray %}
                     {% set datesArray = datesArray|merge([dining.data.date])  %}
                    {% endif %}
                {% endfor %}
            {% endfor %}
            <table class="table">
                <tr>
                    <th></th>

                    {% for date in datesArray %}
                        <th>{{ date }}</th>
                    {% endfor %}


                </tr>

                {% for dining in form.diningDates.vars.choices %}
                    <tr>
                        <th>{{ dining|first.data.dining.diningType.name }}  ({{dining|first.data.dining.price}},-Ft/fő/alkalom)</th>
                        {% for date in datesArray %}
                            <td>
                                {% for d in dining %}

                                    {% if d.data.date == date %}
                                        {{form_widget(form.diningDates.children[d.data.id])}}
                                    {% endif %}
                                {% endfor %}
                            </td>
                        {% endfor %}

                    </tr>
                {% endfor %}


            </table>
        </div>
        </div>



        {% elseif flow.getCurrentStepNumber() == 4 %}

        {{dump(form.vars.data)}}

        {% elseif flow.getCurrentStepNumber() == 5 %}
            <div class="row">
                <div class="col-sm-4">
                    {{ form_row(form.recaptcha) }}
                </div>
                <div class="col-sm-8">
                </div>
            </div>     
        {% endif %}

        {{ form_rest(form) }}

        {% include 'PixeloidAppBundle:FormFlow:buttons.html.twig' %}

        {{ form_end(form) }}

    </div>
    <div class="col-sm-3">
            <div class="panel panel-default accomodation-selected">
                <div class="panel-body">
                    <h3>Total: <span class="num-nights"></span> nights, <span class="price-total">0</span> EUR</h3>
                </div>
            </div>

    </div>
</div>


<div class="modal fade" id="mapModal" tabindex="-1" role="dialog" aria-labelledby="mapModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="mapModalLabel">New message</h4>
      </div>
      <div class="modal-body">

      </div>
    </div>
  </div>
</div>





<!--         <ul class="record_actions">
    <li>
        <a href="{{ path('eventregistration') }}">
            Back to the list
        </a>
    </li>
</ul>
 -->{% endblock %}
